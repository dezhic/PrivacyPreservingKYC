const test = require('node:test');
const assert = require('node:assert').strict;

test('print random point generated by the codec function', (t) => {
    const { randomPoint } = require('./babyjub-codec256.js');
    const point = randomPoint();
    console.log("Random point on babyjubjub curve, please manually verify that it is on the curve: ");
    console.log(point);
});

const message256 = 0x123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0n;
var point, xmXor;

test('encode a message to a point and xor value of the message and point.x', (t) => {
    const { encode } = require('./babyjub-codec256.js');
    const result = encode(message256);
    point = result.point;
    xmXor = result.xmXor;
    assert.strictEqual(point[0] ^ xmXor, message256);
});

test('decode a point and xor value to a message', (t) => {
    const { decode } = require('./babyjub-codec256.js');
    const message = decode(point, xmXor);
    assert.strictEqual(message, message256);
});
